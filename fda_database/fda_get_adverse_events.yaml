name: fda_get_adverse_events

description: >
  Query the FDA Adverse Event Reporting System (FAERS) for drug-related adverse events.
  Retrieves post-market safety surveillance data including reaction types, patient outcomes, and reporter information.
  Essential for pharmacovigilance, safety signal detection, and benefit-risk assessment.
  Data is voluntarily reported and may contain duplicates or inaccuracies; use statistical methods for signal detection.

required_parameters:
  - name: drug_name
    type: str
    default: null
    description: >
      Name of the drug to search adverse events for. Can be brand name or generic name.
      Matches against 'patient.drug.medicinalproduct' field in FAERS database.
      Partial matches supported (e.g., 'ibupro' matches 'ibuprofen').

optional_parameters:
  - name: date_range
    type: str
    default: null
    description: >
      Date range for adverse event reports in format 'YYYYMMDD:YYYYMMDD'.
      Example: '20230101:20231231' for all of 2023.
      Filters on 'receivedate' field. If null, returns all available dates.

  - name: reaction
    type: str
    default: null
    description: >
      Specific adverse reaction to filter for (e.g., 'nausea', 'headache', 'death').
      Searches 'patient.reaction.reactionmeddrapt' field using MedDRA terminology.
      If null, returns all reactions for the drug.

  - name: serious_only
    type: bool
    default: false
    description: >
      If true, only return serious adverse events (death, hospitalization, disability, etc.).
      Filters using 'serious' field in FAERS.
      Performance impact: minimal, reduces result set size.

  - name: limit
    type: int
    default: 100
    description: >
      Maximum number of adverse event reports to return. Range: 1-1000.
      Large limits (>500) may cause slower responses and higher memory usage.
      Recommended: 100 for exploratory analysis, 1000 for comprehensive safety review.

  - name: country
    type: str
    default: null
    description: >
      Filter by country code (e.g., 'US', 'CA', 'GB').
      Searches 'occurcountry' field.
      Useful for region-specific safety analysis.

hardware_requirements:
  device: cpu_only
  notes: >
    No GPU required. Network-based API call to openFDA.
    Memory usage depends on limit parameter: ~1KB per event, ~1MB for 1000 events.
    Requires stable internet connection.
    CPU usage minimal (<5% on modern processors).

time_complexity:
  assumptions: >
    Wall-clock latency with 100 Mbps internet connection.
    CPU: Apple M1 or equivalent.
    Includes API request, JSON parsing, and data structuring.
    FDA API response time typically 300-800ms depending on query complexity.
    Large result sets (limit=1000) add 200-500ms for data transfer.
  latency_seconds:
    n1: 0.8
    n2: 1.6
    n10: 8.0
    batch_10: 3.5
    large_query: 1.5

outputs:
  type: dict
  schema:
    results: list[dict]
    total_count: int
    fields:
      - safetyreportid
      - receivedate
      - serious
      - seriousnessdeath
      - seriousnesshospitalization
      - patient.reaction
      - patient.drug
      - patient.patientsex
      - patient.patientonsetage
      - primarysource.reportercountry
  example:
    results:
      - safetyreportid: "12345678"
        receivedate: "20240115"
        serious: "1"
        seriousnesshospitalization: "1"
        patient:
          reaction:
            - reactionmeddrapt: NAUSEA
            - reactionmeddrapt: VOMITING
          drug:
            - medicinalproduct: IBUPROFEN
              drugcharacterization: "1"
          patientsex: "2"
          patientonsetage: "45"
    total_count: 1234

failure_modes:
  - error: No results found
    cause: Drug name not found in FAERS database or no events in date range
    fix: Try alternative drug names (brand vs generic), expand date range, or verify spelling

  - error: RateLimitError 429
    cause: Exceeded FDA API rate limits (240 requests/minute)
    fix: Implement request throttling, add API key, or use exponential backoff

  - error: Timeout
    cause: Complex query or large result set causing slow API response
    fix: Reduce limit, narrow date range, add specific reaction filter, or increase timeout

  - error: Invalid date format
    cause: Date range not in YYYYMMDD:YYYYMMDD format
    fix: Reformat dates to YYYYMMDD (e.g., 20230101:20231231)

  - error: Memory error with large results
    cause: Result set too large (limit=1000, many matches)
    fix: Process in batches using pagination (skip parameter), or filter more specifically
